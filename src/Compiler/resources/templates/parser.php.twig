<?php
/**
{% for line in header %}
 * {{ line }}
{% endfor %}
 */
{% if strict %}
declare(strict_types=1);
{% endif %}
{% if namespace %}

namespace {{ namespace }};
{% endif %}

use Railt\Compiler\Parser\Runtime as {{ class }}Runtime;

/**
 * This class has been auto-generated by the {{ self }}
 */
final class {{ class }} extends {{ class }}Runtime
{
    public function __construct()
    {
        $lexer = new {{ lexer }}();

        parent::__construct($lexer, $this->getRules());
    }

    /**
     * @return \Railt\Compiler\Parser\Rule\Rule[]
     */
    public function getRules(): array
    {
        return [
            {% for key, rule in rules %}
{{ key | value | raw }} =>
new \{{ rule|class}}({%for a in rule.toArray%}{{a|value|replace({"\n":""," ":""})|raw}}{%if not loop.last%}, {%endif%}
{% endfor %}),
            {% endfor %}
        ];
    }

    /**
     * @return string Returns the lexer compilation date and time in RFC3339 format
     */
    public function getBuiltDate(): string
    {
        return {{ "now" | date("Y-m-d\TH:i:s.vP") | string | raw }};
    }
}
